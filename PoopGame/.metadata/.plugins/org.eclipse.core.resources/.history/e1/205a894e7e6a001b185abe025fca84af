package poopgame.ui;

import com.badlogic.ashley.core.Entity;

import poopgame.gamelogic.components.PlayerComponent;
import poopgame.server.GameServer;
import poopgame.server.LocalServer;

public class WinScreen extends MenuPanel {
	private static final long serialVersionUID = 1L;
	
	private GameServer server;
	private Long activePlayerId;

	public WinScreen(Entity winner, GameServer server, Long activePlayerId) {
		super("wrap 2, fill, insets 50", "[grow]50px[right]", "");
		
		MenuButton exitButton = new MenuButton("EXIT");
		exitButton.addActionListener(e -> showMainMenu());
		add(exitButton);
		MenuButton startButton = new MenuButton("RETURN TO LOBBY");
		startButton.setEnabled(server instanceof LocalServer);
		startButton.addActionListener(e -> returnToLobby());
		add(startButton);
	}

	private Object returnToLobby() {
		for (PlayerComponent player : server.getPlayers()) {
			if (player.id == activePlayerId) {
				SwingFrame.goTo(new Lobby(server, server.getP));
			}
		}
	}

	private Object showMainMenu() {
		server.dispose();
		SwingFrame.goTo(new MainMenu());
	}

}
