package poopgame.gamelogic.abilities.special;

import com.badlogic.ashley.core.Entity;
import com.badlogic.gdx.physics.box2d.Body;

import poopgame.gamelogic.Player;
import poopgame.gamelogic.Poop;
import poopgame.gamelogic.engine.TimeEngine;
import poopgame.physics.components.BodyComponent;
import util.GenericListener;

public class NinjaSpecial extends SpecialAbility implements GenericListener<Poop> {
	
	private static final String LAST_POOP_STAT_NAME = "lastPoop";

	public NinjaSpecial(Player player) {
		super(player);
		player.addShootListener(this);
		player.getStats().setEnergyRegen(50f);
	}

	@Override
	public void cast(TimeEngine engine) {
		String lastPoopId = player.getStats().getStat(LAST_POOP_STAT_NAME, String.class);
		if (lastPoopId != null) {
			Entity lastPoop = engine.getEntityById(lastPoopId);
			if (lastPoop != null) {
				Body playerBody = player.getBody();
				BodyComponent poopBodyComp = lastPoop.getComponent(BodyComponent.class);
				Body poopBody = poopBodyComp != null ? poopBodyComp.body : null;
				if (playerBody != null && poopBody != null) {
					Transform playerTransform = playerBody.getTransform();
					playerBody.setTransform(, angle);
				}
			}
		} else {
			player.getStats().setEnergy(100f);
		}
	}

	@Override
	public void actionPerformed(Poop poop) {
		player.getStats().setStat(LAST_POOP_STAT_NAME, poop.getIdentifier());
	}

}